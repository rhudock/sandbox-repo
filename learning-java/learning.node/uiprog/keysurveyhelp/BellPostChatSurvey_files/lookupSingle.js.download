if(window.LQ_Single){throw"There is another instance of LQ_Single! Check JS includes.";}var LQ_Multiple=null;var LQ_Single=(function(g,m){var q=function(B,z,y){var F=LQ_Core.getLookupEnv().valueDelimiter;var D=LQ_Core.getLookupEnv().valueEquals;var E=LQ_Core.getEmptyText(B,z);LQ_Utils.log("createOptionsHtml:["+B+", "+z+"], valueDelimiter: "+F+", valueEquals: "+D);var A="";A+='<li lang="'+E+F+E+'" class=" dropdownText selectItem  " dir="auto" id="'+z+"_0\" onclick='LQ_Core.doSelect("+B+', "'+z+'", 0)\' title="'+E+'">'+E+"</li>";if(y!=null&&y.length>0){var w=y.split(F);for(var x=0;x<w.length;x++){var C=w[x];C=KS_Utils.encodeForJS(C);var v=C.split(D);A+='<li lang="'+v[0]+F+v[1]+'" class="dropdownText selectItem" dir="auto" id="'+z+"_"+(x+1)+"\" onclick='LQ_Core.doSelect("+B+', "'+z+'", '+(x+1)+")'  title=\""+v[1]+'">'+v[1]+"</li>";}}return A;};var k=function(w,v){LQ_Core.addFinalListeners(w,v);return false;};var c=function(x,w,v){LQ_Core.showFinalSelectedResult(x,w,v);return false;};var p=function(A){var z=LQ_Core.getAnswerObjectId(A);var x=LQ_Core.getAnswerObjectViewId(A);LQ_Utils.log("LQ showResultsOffline! qid="+A+", answerObjectId="+z+", answerObjectViewId="+x);var w=g(n(A,z));if(w.length<=0){LQ_Utils.log("LQ OFFLINE/NO ObjectID Input for: qid="+A+", answerId="+z);return false;}var y=w.val();if(y!=null&&y.length>0){LQ_Utils.log("Restore lookup result ["+A+"] in offline mode...");var v=g(n(A,x)).val();LQ_Utils.log("Found offline result: value="+y+", view="+v);LQ_Core.showFinalSelectedResult(A,y,v);}else{LQ_Utils.log("LQ OFFLINE/NO Result for: qid="+A+", answerId="+z);}return false;};var f=function(v){return !LQ_Core.isOffline()||(window.appRoot!=undefined&&window.appRoot.getPlatform()=="win7");};var a=function(z,x,w){var v=LQ_Utils.getFinalSelectId(z);if(x&&x.selected){LQ_Core.resetSelect(z,v);LQ_Core.populateResult(z,null,null);var y=LQ_Utils.getHiddenElements(z);if(y.length>0){y.val("");}}return false;};var l=function(w,v){LQ_Core.clearFiltersGUI(w,v);};var r=function(x,w,v){return function(z,B){var y=z.value;var A=z.row;LQ_Utils.log("change [final select] qid="+x+", row="+A+", dataObjectId="+y);if(LQ_Core.getDropdownValue(v)==y){LQ_Utils.log("Onchange: value is not changed. The end. "+v);if(B){B();}return false;}LQ_Core.setDropdownValue(v,(A==0)?null:y);if(m.isSelectorTag){LQ_Core.fireGlobalChangeEvent(z);if(B){B();}return false;}if(A==0||!y||y==0){LQ_Core.populateResult(x,null,null);LQ_Core.fireGlobalChangeEvent(z);if(B){B();}return false;}if(LQ_Core.isOffline()){return LQ_Offline.loadFinalResultsById(LQ_Core,x,y,B);}else{return LQ_Online.loadFinalResultsById(LQ_Core,x,y,w,B);}return false;};};var h=function(x,w){var v=g("input[type=hidden]#inputtextother"+x+"_"+w);if(v.length>0){return v;}return g("#hidden_inputtextother"+x+"_"+w);};var s=function(A,z,y){var x=LQ_Core.isPresentOnVisualPage(A);var v=x?n().substring(1):b(A,z).substring(1);var w="other"+A+"_"+z;g(document.theForm).append(g("<input/>",{type:"hidden",name:w,value:y,id:v}));};var d=function(A,v,w){var z=LQ_Core.getAnswerIds(A);var D=LQ_Core.isPresentOnVisualPage(A);for(var x=0;x<z.length;x++){var B=z[x];var C=(w==null)?"":w[B];var y=D?g(n(A,B)):h(A,B);if(y.length>0){y.val(C);}else{s(A,B,C);}}LQ_Utils.log("Results are "+(w==null?"reset":"set")+" for QID: "+A+", ObjectID: "+v);LQ_Core.fireLookupResultsListeners(A);};var e=function(x){var w=LQ_Core.getAnswerObjectId(x);var v=i(x,w);return v.length>0&&v.val().length>0;};var o=function(y,x){if(!e(y)){return null;}var w=(x)?x:LQ_Core.getAnswerObjectViewId(y);var v=i(y,w);return v.val();};var i=function(x,w){var v=g(n(x,w));if(v.length==0){v=h(x,w);}return v;};var j=function(A,x,z){var v=t(x,z);if(v==null){LQ_Utils.log("There is no selected option for: "+x);return new LQ_Event(x,null,null,A,z,false);}var y=v[0];var w=v[1];LQ_Utils.log("doSelect: "+A+", "+x+", value="+y+", view="+w);return new LQ_Event(x,w,y,A,z,true,undefined);};var t=function(w,y){if(y==null){return null;}var x=g("#"+w+"_"+y);var v=x.attr("lang");if(v){v=KS_Utils.decodeFromJS(v);return v.split(LQ_Core.getLookupEnv().valueDelimiter);}else{return null;}};var u=function(w,y,x){if(x){var v=i(y,LQ_Core.getAnswerObjectViewId(y)).val();LQ_Core.showFinalSelectedResult(y,x,v);}};var n=function(w,v){return"#inputtextother"+w+"_"+v;};var b=function(w,v){return"#hidden_inputtextother"+w+"_"+v;};return{createOptionsHtml:q,initFinalSelect:k,showResultsOnline:c,showResultsOffline:p,isCursorSupported:f,resetFinalSelect:a,getFinalSelectListener:r,populateResult:d,isSomethingSelected:e,getSelectionDropdownEvent:j,selectValue:u,resetFilters:l,getResultAsText:o};})(jQuery,LQ_GuiConfig);